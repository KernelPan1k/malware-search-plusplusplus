// Running this function directly from a background page will not work
function copyToClipboard(text) {
    function oncopy(event) {
        document.removeEventListener("copy", oncopy, true);
        // Hide the event from the page to prevent tampering.
        event.stopImmediatePropagation();

        // Overwrite the clipboard content.
        event.preventDefault();
        event.clipboardData.setData("text", text);
        console.log("text: " + text);
    }

    document.addEventListener("copy", oncopy, true);
    

    document.execCommand("copy");
}